var admin=angular.module("app",["shared"]);admin.config(["$stateProvider",function(t){t.state("main",{url:"/",views:{"":{templateUrl:"/app/shared/views/main.view.html",controller:"mainViewController as mainVm"},"content-container@main":{templateUrl:"/app/shared/views/content-container.view.html",controller:"dashboardContentContainerController as vm"},"toolbar@main":{templateUrl:"/app/shared/templates/toolbar.template.html",controller:"dashboardToolbarController as vm"},"content@main":{templateUrl:"/app/admin/templates/content/dashboard-content.template.html"}},resolve:{authentication:["MaterialDesign","User","$state",function(t,a,e){return a.get().then(function(t){a.set(t.data)},function(){e.go("page-not-found")})}]}})}]),admin.controller("dashboardContentContainerController",["MaterialDesign","toolbarService","ShiftSchedule","Task","User","Chart",function(t,a,e,n,o,i){var r=this;r.toolbar=a,r.task=n,r.user=o,r.shiftSchedule=e,r.chart=i,r.dashboard=function(){r.task.dashboard().then(function(t){r.shiftSchedule.toDateObject(),r.task.data=t.data})},r.init=function(){r.dashboard()},r.init()}]),admin.controller("calendarDialogController",["MaterialDesign","ShiftSchedule","formService","Task",function(t,a,e,n){var o=this;o.label="Go to date",o.data={},o.cancel=function(){e.cancel()},o.toLocaleTimeString=function(){o.data.timeStart=o.data.timeStart.toLocaleTimeString(),o.data.timeEnd=o.data.timeEnd.toLocaleTimeString()},o.toDateString=function(){o.data.dateShift=o.data.dateShift.toDateString()},o.toDateObject=function(){var t=new Date;o.data.timeStart=new Date(t.toDateString()+" "+o.data.timeStart),o.data.timeEnd=new Date(t.toDateString()+" "+o.data.timeEnd),o.data.dateShift=new Date(o.data.dateShift)},o.data.dateShift=new Date,o.data.timeStart=e.timeFormat(new Date),o.data.timeEnd=e.timeFormat(new Date),o.submit=function(){e.validate(o.form)||(o.busy=!0,o.toLocaleTimeString(),o.toDateString(),n.dashboard(o.data).then(function(a){n.data=a.data,t.hide()},function(){t.error()}))}}]),admin.controller("downloadDialogController",["MaterialDesign","ShiftSchedule","formService","$window",function(t,a,e,n){var o=this;o.label="Download",o.data={},o.cancel=function(){e.cancel()},o.toLocaleTimeString=function(){o.data.time_start=o.data.time_start.toLocaleTimeString(),o.data.time_end=o.data.time_end.toLocaleTimeString()},o.toDateString=function(){o.data.date_start=o.data.date_start.toDateString(),o.data.date_end=o.data.date_end.toDateString()},o.toDateObject=function(){var t=new Date;o.data.time_start=new Date(t.toDateString()+" "+o.data.time_start),o.data.time_end=new Date(t.toDateString()+" "+o.data.time_end),o.data.date_start=new Date(o.data.date_start),o.data.date_end=new Date(o.data.date_end)},o.data.date_start=new Date,o.data.date_end=new Date,o.data.time_start=e.timeFormat(new Date),o.data.time_end=e.timeFormat(new Date),o.submit=function(){e.validate(o.form)||(o.busy=!0,o.toLocaleTimeString(),o.toDateString(),n.open("/task/download/"+o.data.date_start+"/to/"+o.data.date_end+"/at/"+o.data.time_start+"/until/"+o.data.time_end,"_blank"),t.hide())}}]),admin.controller("settingsDialogController",["MaterialDesign","ShiftSchedule","formService",function(t,a,e){var n=this;n.label="Settings",n.shiftSchedule=a,n.cancel=function(){e.cancel()},n.submit=function(){if(!e.validate(n.form)){n.busy=!0,n.shiftSchedule.toLocaleTimeString();var a=function(){n.shiftSchedule.toDateObject(),n.busy=!1,t.error()};n.new?n.shiftSchedule.store().then(function(a){n.busy=!1,t.notify("Shift schedule saved."),t.hide()},function(){a()}):n.shiftSchedule.update().then(function(a){n.busy=!1,t.notify("Changes saved."),t.hide()},function(){a()})}},n.init=function(){n.shiftSchedule.index().then(function(t){t.data?(n.shiftSchedule.data=t.data,n.shiftSchedule.toDateObject()):(n.new=!0,n.shiftSchedule.init())},function(){t.error()})}()}]),admin.controller("dashboardToolbarController",["MaterialDesign","toolbarService","Task",function(t,a,e){var n=this;n.toolbar=a,n.toolbar.content=e,n.toolbar.parentState=null,n.toolbar.childState="Dashboard",n.toolbar.hideSearchIcon=!0,n.toolbar.searchAll=!1,n.toolbar.options=!1,n.toolbar.showInactive=!1,n.sort=[{label:"Recently added",type:"created_at",sortReverse:!1}]}]);