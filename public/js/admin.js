var admin=angular.module("app",["shared"]);admin.config(["$stateProvider",function(t){t.state("main",{url:"/",views:{"":{templateUrl:"/app/shared/views/main.view.html",controller:"mainViewController as mainVm"},"content-container@main":{templateUrl:"/app/shared/views/content-container.view.html",controller:"dashboardContentContainerController as vm"},"toolbar@main":{templateUrl:"/app/shared/templates/toolbar.template.html",controller:"dashboardToolbarController as vm"},"content@main":{templateUrl:"/app/admin/templates/content/dashboard-content.template.html"}},resolve:{authentication:["MaterialDesign","User","$state",function(t,a,e){return a.get().then(function(t){a.set(t.data)},function(){e.go("page-not-found")})}]}})}]),admin.controller("dashboardContentContainerController",["MaterialDesign","toolbarService","ShiftSchedule","Task","User","Chart",function(t,a,e,n,i,o){function r(){return s.task.dashboard().then(function(t){return s.isLoading=!1,s.task.data=t.data,s.task.data.length&&angular.forEach(s.task.data,function(t){d(t)}),s.task.data}).catch(l)}function d(t){var e={};e.display=t.name,a.items.push(e)}function l(){return t.failed().then(function(){r()}).catch(l)}function c(){s.dashboard(),s.isLoading=!0}var s=this;s.toolbar=a,s.task=n,s.user=i,s.chart=o,s.dashboard=r,s.init=c,s.init()}]),admin.controller("calendarDialogController",["MaterialDesign","ShiftSchedule","formService","Task",function(t,a,e,n){var i=this;i.label="Go to date",i.data={},i.cancel=function(){e.cancel()},i.toLocaleTimeString=function(){i.data.timeStart=i.data.timeStart.toLocaleTimeString(),i.data.timeEnd=i.data.timeEnd.toLocaleTimeString()},i.toDateString=function(){i.data.dateShift=i.data.dateShift.toDateString()},i.toDateObject=function(){var t=new Date;i.data.timeStart=new Date(t.toDateString()+" "+i.data.timeStart),i.data.timeEnd=new Date(t.toDateString()+" "+i.data.timeEnd),i.data.dateShift=new Date(i.data.dateShift)},i.data.dateShift=new Date,i.data.timeStart=e.timeFormat(new Date),i.data.timeEnd=e.timeFormat(new Date),i.submit=function(){e.validate(i.form)||(i.busy=!0,i.toLocaleTimeString(),i.toDateString(),n.dashboard(i.data).then(function(a){n.data=a.data,t.hide()},function(){t.error()}))}}]),admin.controller("downloadDialogController",["Department","User","MaterialDesign","formService","$window",function(t,a,e,n,i){function o(){return r.department.index().then(function(t){r.department.data=t.data}).catch(function(){e.error()})}var r=this;r.department=t,r.user=a,r.label="Download",r.data={},r.init=o,r.cancel=function(){n.cancel()},r.toLocaleTimeString=function(){r.data.time_start=r.data.time_start.toLocaleTimeString(),r.data.time_end=r.data.time_end.toLocaleTimeString()},r.toDateString=function(){r.data.date_start=r.data.date_start.toDateString(),r.data.date_end=r.data.date_end.toDateString()},r.toDateObject=function(){var t=new Date;r.data.time_start=new Date(t.toDateString()+" "+r.data.time_start),r.data.time_end=new Date(t.toDateString()+" "+r.data.time_end),r.data.date_start=new Date(r.data.date_start),r.data.date_end=new Date(r.data.date_end)},r.data.date_start=new Date,r.data.date_end=new Date,r.data.time_start=n.timeFormat(new Date),r.data.time_end=n.timeFormat(new Date),r.submit=function(){n.validate(r.form)||(r.busy=!0,r.toLocaleTimeString(),r.toDateString(),i.open("/task/download/"+r.data.date_start+"/to/"+r.data.date_end+"/at/"+r.data.time_start+"/until/"+r.data.time_end+"/department/"+r.data.department_id,"_blank"),e.hide())},r.init()}]),admin.controller("settingsDialogController",["MaterialDesign","ShiftSchedule","formService",function(t,a,e){var n=this;n.label="Settings",n.shiftSchedule=a,n.cancel=function(){e.cancel()},n.submit=function(){if(!e.validate(n.form)){n.busy=!0,n.shiftSchedule.toLocaleTimeString();var a=function(){n.shiftSchedule.toDateObject(),n.busy=!1,t.error()};n.new?n.shiftSchedule.store().then(function(a){n.busy=!1,t.notify("Shift schedule saved."),t.hide()},function(){a()}):n.shiftSchedule.update().then(function(a){n.busy=!1,t.notify("Changes saved."),t.hide()},function(){a()})}},n.init=function(){n.shiftSchedule.index().then(function(t){t.data?(n.shiftSchedule.data=t.data,n.shiftSchedule.toDateObject()):(n.new=!0,n.shiftSchedule.init())},function(){t.error()})}()}]),admin.controller("dashboardToolbarController",["MaterialDesign","toolbarService","Task",function(t,a,e){var n=this;n.toolbar=a,n.toolbar.content=e,n.toolbar.parentState=null,n.toolbar.childState="Dashboard",n.toolbar.hideSearchIcon=!1,n.toolbar.searchAll=!1,n.toolbar.options=!1,n.toolbar.showInactive=!1,n.sort=[{label:"Recently added",type:"created_at",sortReverse:!1}]}]);