var admin=angular.module("app",["shared"]);admin.config(["$stateProvider",function(t){t.state("main",{url:"/",views:{"":{templateUrl:"/app/shared/views/main.view.html",controller:"mainViewController as mainVm"},"content-container@main":{templateUrl:"/app/shared/views/content-container.view.html",controller:"dashboardContentContainerController as vm"},"toolbar@main":{templateUrl:"/app/shared/templates/toolbar.template.html",controller:"dashboardToolbarController as vm"},"content@main":{templateUrl:"/app/admin/templates/content/dashboard-content.template.html"}},resolve:{authentication:["MaterialDesign","User","$state",function(t,a,e){return a.get().then(function(t){a.set(t.data)},function(){e.go("page-not-found")})}]}})}]),admin.controller("dashboardContentContainerController",["MaterialDesign","toolbarService","ShiftSchedule","Task","User","Chart",function(t,a,e,n,i,o){function r(){return c.task.dashboard().then(function(t){return c.isLoading=!1,c.task.data=t.data,c.task.data}).catch(d)}function d(){return t.failed().then(function(){r()}).catch(d)}function l(){c.dashboard(),c.isLoading=!0}var c=this;c.toolbar=a,c.task=n,c.user=i,c.chart=o,c.dashboard=r,c.init=l,c.init()}]),admin.controller("calendarDialogController",["MaterialDesign","ShiftSchedule","formService","Task",function(t,a,e,n){var i=this;i.label="Go to date",i.data={},i.cancel=function(){e.cancel()},i.toLocaleTimeString=function(){i.data.timeStart=i.data.timeStart.toLocaleTimeString(),i.data.timeEnd=i.data.timeEnd.toLocaleTimeString()},i.toDateString=function(){i.data.dateShift=i.data.dateShift.toDateString()},i.toDateObject=function(){var t=new Date;i.data.timeStart=new Date(t.toDateString()+" "+i.data.timeStart),i.data.timeEnd=new Date(t.toDateString()+" "+i.data.timeEnd),i.data.dateShift=new Date(i.data.dateShift)},i.data.dateShift=new Date,i.data.timeStart=e.timeFormat(new Date),i.data.timeEnd=e.timeFormat(new Date),i.submit=function(){e.validate(i.form)||(i.busy=!0,i.toLocaleTimeString(),i.toDateString(),n.dashboard(i.data).then(function(a){n.data=a.data,t.hide()},function(){t.error()}))}}]),admin.controller("downloadDialogController",["MaterialDesign","ShiftSchedule","formService","$window",function(t,a,e,n){var i=this;i.label="Download",i.data={},i.cancel=function(){e.cancel()},i.toLocaleTimeString=function(){i.data.time_start=i.data.time_start.toLocaleTimeString(),i.data.time_end=i.data.time_end.toLocaleTimeString()},i.toDateString=function(){i.data.date_start=i.data.date_start.toDateString(),i.data.date_end=i.data.date_end.toDateString()},i.toDateObject=function(){var t=new Date;i.data.time_start=new Date(t.toDateString()+" "+i.data.time_start),i.data.time_end=new Date(t.toDateString()+" "+i.data.time_end),i.data.date_start=new Date(i.data.date_start),i.data.date_end=new Date(i.data.date_end)},i.data.date_start=new Date,i.data.date_end=new Date,i.data.time_start=e.timeFormat(new Date),i.data.time_end=e.timeFormat(new Date),i.submit=function(){e.validate(i.form)||(i.busy=!0,i.toLocaleTimeString(),i.toDateString(),n.open("/task/download/"+i.data.date_start+"/to/"+i.data.date_end+"/at/"+i.data.time_start+"/until/"+i.data.time_end,"_blank"),t.hide())}}]),admin.controller("settingsDialogController",["MaterialDesign","ShiftSchedule","formService",function(t,a,e){var n=this;n.label="Settings",n.shiftSchedule=a,n.cancel=function(){e.cancel()},n.submit=function(){if(!e.validate(n.form)){n.busy=!0,n.shiftSchedule.toLocaleTimeString();var a=function(){n.shiftSchedule.toDateObject(),n.busy=!1,t.error()};n.new?n.shiftSchedule.store().then(function(a){n.busy=!1,t.notify("Shift schedule saved."),t.hide()},function(){a()}):n.shiftSchedule.update().then(function(a){n.busy=!1,t.notify("Changes saved."),t.hide()},function(){a()})}},n.init=function(){n.shiftSchedule.index().then(function(t){t.data?(n.shiftSchedule.data=t.data,n.shiftSchedule.toDateObject()):(n.new=!0,n.shiftSchedule.init())},function(){t.error()})}()}]),admin.controller("dashboardToolbarController",["MaterialDesign","toolbarService","Task",function(t,a,e){var n=this;n.toolbar=a,n.toolbar.content=e,n.toolbar.parentState=null,n.toolbar.childState="Dashboard",n.toolbar.hideSearchIcon=!0,n.toolbar.searchAll=!1,n.toolbar.options=!1,n.toolbar.showInactive=!1,n.sort=[{label:"Recently added",type:"created_at",sortReverse:!1}]}]);