function fab(){return{}}function Position(e){function t(e,t){o[$key]=t}function r(e){return o[e]}function n(){return e.get("/position")}function a(t){return e.post("/position/enlist",t)}var o={index:n,set:t,get:r,enlist:a};return o}var shared=angular.module("shared",["ui.router","ngMaterial","ngMessages","infinite-scroll","highcharts-ng","angularMoment","angularFileUpload","ui.bootstrap"]);shared.config(["$urlRouterProvider","$stateProvider","$mdThemingProvider","$qProvider",function(e,t,r,n){n.errorOnUnhandledRejections(!1),r.theme("default").primaryPalette("indigo").accentPalette("amber"),r.theme("dark-purple").backgroundPalette("deep-purple").dark(),r.theme("dark-orange").backgroundPalette("orange").dark(),e.otherwise("/page-not-found").when("","/"),t.state("page-not-found",{url:"/page-not-found",templateUrl:"/app/shared/views/page-not-found.view.html"})}]),shared.factory("Account",["$http","MaterialDesign",function(e,t){var r={};return r.data=[],r.enlist=function(t){return e.post("/account/enlist",t)},r}]),shared.factory("Chart",function(){var e={};return e.data={title:{},subtitle:{},xAxis:{crosshair:!0},yAxis:[{min:0,title:{text:"Compeleted Tasks"}}],plotOptions:{column:{dataLabels:{enabled:!0},enableMouseTracking:!0}},series:[{name:"New",type:"column"},{name:"Revisions",type:"column"}],navigation:{buttonOptions:{enabled:!0}}},e.config=function(t,r){return e.data.title.text=t.name+" - "+r.name,e.data.subtitle.text=t.range,e.data.xAxis.categories=r.names,e.data.series[0].data=r.new,e.data.series[1].data=r.revisions,e.data},e}),shared.factory("Department",["$http",function(e){function t(){return e.get("department")}return{data:[],index:t}}]),shared.factory("changePasswordService",["$http","MaterialDesign",function(e,t){var r={};return r.verifyPassword=function(){return e.post("/user/verify-password",r.data)},r.cancel=function(){r.init(),t.cancel()},r.submit=function(){return e.post("/user/change-password",r.data)},r.init=function(){r.data={}},r}]),function(){"use strict";function e(e){function t(t){return e.post("/experience/enlist",t)}return{enlist:t}}angular.module("shared").factory("Experience",e),e.$inject=["$http"]}(),shared.factory("fab",fab),shared.factory("formService",["MaterialDesign",function(e){var t={};return t.validate=function(e){if(e.$invalid)return angular.forEach(e.$error,function(e){angular.forEach(e,function(e){e.$setTouched()})}),!0},t.cancel=function(){e.cancel()},t.timeFormat=function(e){return e.getMinutes()<30?e.setMinutes(30):e.getMinutes()>30&&(e.setHours(e.getHours()+1),e.setMinutes(0)),e.setSeconds(0),e},t}]),shared.factory("MaterialDesign",["$mdDialog","$mdToast","$q",function(e,t,r){var n={};return n.alert=function(t){return e.show(e.alert().parent(angular.element($("body"))).clickOutsideToClose(!0).title(t.title).textContent(t.message).ariaLabel(t.title).ok("Got it!"))},n.customDialog=function(t){var r={controller:t.controller,templateUrl:t.templateUrl,parent:angular.element(document.body),fullscreen:t.fullscreen};return e.show(r)},n.confirm=function(t){var r=e.confirm().title(t.title).textContent(t.message).ariaLabel(t.title).ok(t.ok).cancel(t.cancel);return e.show(r)},n.prompt=function(t){var r=e.prompt().title(t.title).textContent(t.message).placeholder(t.placeholder).ariaLabel(t.title).ok(t.ok).cancel(t.cancel);return e.show(r)},n.notify=function(e){var r=t.simple().textContent(e).position("bottom right").hideDelay(3e3);return t.show(r)},n.preloader=function(){e.show({templateUrl:"/app/shared/templates/loading.template.html",parent:angular.element(document.body)})},n.cancel=function(){return e.cancel()},n.hide=function(t){return e.hide(t)},n.error=function(){var e={title:"Oops! Something went wrong!",message:"An error occured. Please try again later."};return n.alert(e),n.reject()},n.reject=function(){return r.reject()},n.failed=function(){var e={title:"Aw Snap!",message:"An error occured loading the resource.",ok:"Try Again"};return n.confirm(e)},n}]),shared.factory("Position",Position),Position.$inject=["$http"],shared.factory("ShiftSchedule",["$http","MaterialDesign","formService",function(e,t,r){var n={};return n.data={},n.index=function(){return e.get("/shift-schedule")},n.store=function(){return e.post("/shift-schedule",n.data)},n.update=function(){return e.put("/shift-schedule/"+n.data.id,n.data)},n.toLocaleTimeString=function(){n.data.from=n.data.from.toLocaleTimeString(),n.data.to=n.data.to.toLocaleTimeString()},n.toDateObject=function(){var e=new Date;n.data.from=new Date(e.toDateString()+" "+n.data.from),n.data.to=new Date(e.toDateString()+" "+n.data.to)},n.init=function(){var e=new Date;n.data={},n.data.from=r.timeFormat(e),n.data.to=r.timeFormat(e)},n}]),shared.factory("Task",["$http","MaterialDesign","toolbarService",function(e,t,r){var n={};return n.data=[],n.search=function(e){n.query.search=e,n.init()},n.refresh=function(){n.query.search=null,n.init()},n.enlist=function(t){return e.post("/task/enlist",t)},n.paginate=function(t,r){return e.post("/task/enlist?page="+r,t)},n.pause=function(){return e.post("/task/pause/"+n.current.id)},n.resume=function(){return e.post("/task/resume/"+n.current.id,n.current.pauses[0])},n.dashboard=function(t){return e.post("/task/dashboard",t)},n.finish=function(){return e.post("/task/finish/"+n.current.id,n.current.pauses.length?n.current.pauses[0]:null)},n.delete=function(t){return e.delete("/task/"+t)},n.formatData=function(e){e.created_at=new Date(e.created_at),e.ended_at=e.ended_at?new Date(e.ended_at):null},n.pushItem=function(e){n.data.push(e)},n.setToolbarItems=function(e){var t={};t.display=e.title,t.date=new Date(e.created_at).toDateString()+new Date(e.ended_at).toDateString(),r.items.push(t)},n}]),shared.factory("toolbarService",["$http","$filter","MaterialDesign",function(e,t,r){var n={};return n.items=[],n.showSearchBar=function(){n.searchBar=!0},n.hideSearchBar=function(){n.searchBar=!1,n.searchText="",n.searchItem="",n.refresh()},n.getItems=function(e){return e?t("filter")(n.items,e):n.items},n.sortBy=function(e){e.sortReverse=!e.sortReverse,n.sortType=e.type,n.sortReverse=e.sortReverse},n.toggleActive=function(){n.showInactive=!n.showInactive.showInactive},n.searchUserInput=function(e){n.content.search(e)},n.refresh=function(){n.content.refresh()},n.clearItems=function(){n.items=[]},n.calendar=function(){var e={templateUrl:"/app/admin/templates/dialogs/calendar-dialog.template.html",controller:"calendarDialogController as vm"};r.customDialog(e)},n.settings=function(){var e={templateUrl:"/app/admin/templates/dialogs/settings-dialog.template.html",controller:"settingsDialogController as vm"};r.customDialog(e)},n.download=function(){var e={templateUrl:"/app/admin/templates/dialogs/download-dialog.template.html",controller:"downloadDialogController as vm"};r.customDialog(e)},n}]),shared.factory("User",["$http","$state","$filter","MaterialDesign","FileUploader",function(e,t,r,n,a){var o={};return o.user={},o.currentTime=Date.now(),o.get=function(){return e.post("/user/check")},o.update=function(t){return e.put("/user/"+t.id,t)},o.resetPassword=function(t){return e.put("/user/reset-password/"+t.id)},o.delete=function(t){return e.delete("/user/"+t)},o.clone=function(e){return angular.copy(o[e])},o.set=function(e,t){return o[e]=t},o.isSupervisor=function(){return!!r("filter")(o.user.roles,{name:"Supervisor"},!0).length},o.isRankAndFile=function(){return!o.user.roles.length},o.store=function(){return e.post("/user",o.new)},o.enlist=function(t){return e.post("/user/enlist",t)},o.logout=function(){return e.post("/user/logout")},o.checkDefaultPassword=function(){return e.post("/user/check-default-password")},o.changePassword=function(){var e={controller:"changePasswordDialogController as vm",templateUrl:"/app/shared/templates/dialogs/change-password-dialog.template.html"};return n.customDialog(e)},o.uploader={},o.uploader.filter={name:"photoFilter",fn:function(e,t){var r="|"+e.type.slice(e.type.lastIndexOf("/")+1)+"|";return"|jpg|png|jpeg|bmp|gif|".indexOf(r)!==-1}},o.uploader.sizeFilter={name:"enforceMaxFileSize",fn:function(e){return e.size<=2e6}},o.uploader.error=function(e,t,r){n.error(),o.photoUploader.queue=[]},o.headers={"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")},o.photoUploaderInit=function(){o.photoUploader=new a({url:"/user/upload-avatar/"+o.user.id,headers:o.headers,queueLimit:1}),o.photoUploader.filters.push(o.uploader.filter),o.photoUploader.filters.push(o.uploader.sizeFilter),o.photoUploader.onWhenAddingFileFailed=o.uploader.error,o.photoUploader.onAfterAddingFile=function(){o.photoUploader.queue.length&&o.photoUploader.uploadAll()},o.photoUploader.onCompleteItem=function(e,r){o.user.avatar_path?(o.currentTime=Date.now(),o.photoUploader.queue=[]):t.go(t.current,{},{reload:!0})},o.showUploader=!0},o}]),shared.controller("changePasswordDialogController",["User","MaterialDesign","changePasswordService",function(e,t,r){var n=this;n.service=r,n.service.init(),n.verifyPassword=function(){n.service.verifyPassword().then(function(e){n.match=e.data,n.show=!0},function(){n.error=!0})},n.submit=function(){if(n.changePasswordForm.$invalid)return void angular.forEach(n.changePasswordForm.$error,function(e){angular.forEach(e,function(e){e.$setTouched()})});n.service.data.old!=n.service.data.new&&n.service.data.new==n.service.data.confirm&&(n.busy=!0,n.service.submit().then(function(){n.busy=!1,n.service.init(),t.hide(),t.notify("Password changed.")},function(){n.error=!0}))}}]),shared.controller("mainViewController",["User","Experience","MaterialDesign",function(e,t,r){function n(){var e={controller:"experiencesDialogController as vm",templateUrl:"/app/employee/templates/dialogs/experiences-dialog.template.html"};r.customDialog(e).catch(a)}function a(){return r.reject(),u.user.logout().then(function(){window.location.href="/"})}function o(){var e={title:"Change Password",message:"Please change your default password.",ok:"Got it!"};return r.confirm(e)}function i(){if(!e.isRankAndFile())return r.reject();var n={where:[{column:"user_id",condition:"=",value:u.user.user.id}]};return t.enlist(n).then(function(e){if(!e.data.length){var t={title:"Update Positions",message:"Please set your position per project.",ok:"Update"};return r.confirm(t)}return r.reject()})}function s(){return u.user.changePassword()}var u=this;u.user=e,u.logout=a,u.forceChangePassword=o,u.setPositions=n;!function(){u.user.checkDefaultPassword().then(function(e){if(e.data)return u.forceChangePassword().then(s).catch(a)}).then(i).then(n)}()}]);